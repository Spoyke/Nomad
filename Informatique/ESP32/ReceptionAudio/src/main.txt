#include <WiFi.h>
#include <WiFiUdp.h>
#include <driver/i2s.h>
#define Network 1
#define FREQUENCE 8000
#if Network == 1
const char* ssid = "wifi-ensea";
const char* password = "";
#elif Network == 2
const char* ssid = "Livebox-AE90";
const char* password = "qnrVTnqJk2odnwnupj";
#endif

#include <WiFi.h>
#include <WiFiUdp.h>

#define Network 2
#define FREQUENCE 8000
#if Network == 1
const char* ssid = "wifi-ensea";
const char* password = "";
#elif Network == 2
const char* ssid = "Livebox-AE90";
const char* password = "qnrVTnqJk2odnwnupj";
#endif
WiFiUDP udp;
#define UDP_PORT 12345
#define BUFFER_SIZE 128
uint8_t buffer[BUFFER_SIZE];

void setup() {
  Serial.begin(115200);
  WiFi.begin(ssid, password);
  while (WiFi.status() != WL_CONNECTED) {
    delay(500);
    Serial.print(".");
  }
  Serial.println("\nWiFi connectÃ© !");
  Serial.print("IP ESP32 : ");
  Serial.println(WiFi.localIP());

  udp.begin(UDP_PORT);
  dacWrite(25, 0);  // sortie DAC canal 1
}

void loop() {
  int packetSize = udp.parsePacket();
  if (packetSize > 0) {
    int len = udp.read(buffer, min(packetSize, BUFFER_SIZE));
    for (int i = 0; i < len; i++) {
      dacWrite(25, buffer[i]);
      delayMicroseconds(125); // environ 8 kHz
    }
  }
}
